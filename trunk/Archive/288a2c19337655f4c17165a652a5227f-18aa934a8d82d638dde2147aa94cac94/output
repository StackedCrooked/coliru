Vanilla code has a bug
Further tests:
correct correct correct correct correct correct 