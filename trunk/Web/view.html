<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>

    <style type="text/css">
        html, body {
            position: relative;
            margin: 0; padding: 0;
            width: 100%; height: 100%;
        }

        #page {
            position: relative;
            height: 100%;
            padding: 0;
            margin: 8px;
        }

        #editor {
            position: relative;
            margin-bottom: 8px;
            padding: 0;
            width: 100%;
            height: 60%;
        }


        #output {
            position: relative;
            resize: vertical;
            width: 100%;
            height: 138px;
            padding: 0;
            margin-bottom: 8px;
        }

    </style>

</head>
<body>
<div id="page">
    <div id="editor"></div>
    <label for="output"></label><textarea id="output" readonly></textarea>
</div>
<script src="//d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript"></script>
<script>

var editor = ace.edit("editor");
editor.setTheme("ace/theme/textmate");
editor.getSession().setMode("ace/mode/c_cpp");
editor.setBehavioursEnabled(false);
editor.setReadOnly(true);
editor.clearSelection();


var app = {};
app.id = "" + window.location.href.split("?")[1].split('=')[1];
app.editor = editor;
app.output = document.getElementById("output");
app.output.readOnly = true;
app.output.data = "Fetching data....";

app.send = function (location, post_data, f) {
    var httpRequest = new XMLHttpRequest();
    var url = "http://" + window.location.hostname + ":" + window.location.port + '/' + location;
    httpRequest.open("PUT", url, true);
    httpRequest.onreadystatechange = function () {
        if (httpRequest.readyState == 4) {
            if (httpRequest.status == 200) {
                f(httpRequest.responseText.trim());
            }
        }
    };
    httpRequest.send(post_data);
};



app.send(app.id, "", function(response) {
    var parts = response.split('\t');
    if (parts.length > 0) {
        app.editor.setValue(parts[0].replace(/\\t/, "\t"));
    }
    if (parts.length > 1) {
        app.output.value = parts[1].replace(/\\t/, "\t");
    }
    app.editor.clearSelection();
    app.editor.scrollToRow(0);
});


</script>
</body>
</html>
