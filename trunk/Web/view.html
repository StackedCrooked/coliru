<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
    <title>Coliru</title>
</head>
<script type="text/javascript" language="javascript">

var app = {};
app.id = "" + window.location.href.split("?")[1].split('=')[1];
app.elements = {
    editor: null,
    output: null
};



    app.samples = {
        "Hello World!": "#include <iostream>\n#include <thread>\n\nint main()\n{\n    std::cout << \"Hello GCC \" << __VERSION__ << \"!\" << std::endl;\n    std::thread t([](){ std::cout << \"Hello Thread!\"; });\n    t.join();\n}"
    };

    document.write('<frameset rows="100%, 200" border="4" >');
    document.write(' <frame src="frame-top.html" name="top" scrolling="no" frameborder="1" />');
    document.write(' <frame src="frame-bottom.html" name="bottom" scrolling="no" frameborder="1" />');
    document.write('</frameset>');

    app.send = function (location, post_data, f) {
        var httpRequest = new XMLHttpRequest();
        var url = "http://" + window.location.hostname + ":" + window.location.port + '/' + location;
        httpRequest.open("PUT", url, true);
        httpRequest.onreadystatechange = function () {
            if (httpRequest.readyState == 4) {
                if (httpRequest.status == 200) {
                    f(httpRequest.responseText.trim());
                }
            }
        };
        httpRequest.send(post_data);
    };

    app.send(app.id, "", function(response) {
	console.log("response: " + response)
        app.parts = response.split('\t');
	setTimeout(function(){
		app.elements.editor.setReadOnly(true);
	
		if (app.parts.length > 0) {
		    app.elements.editor.setValue(app.parts[0].replace(/\\t/, "\t"));
		}
		if (app.parts.length > 1) {
		    app.elements.output.value = app.parts[1].replace(/\\t/, "\t");
		}
		app.elements.editor.clearSelection();
		app.elements.editor.scrollToRow(0);
	}, 100);
    });
</script>
</html>
