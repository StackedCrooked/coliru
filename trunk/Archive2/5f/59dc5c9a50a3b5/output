0000000: 0102 0304 0506 2369 6e63 6c75 6465 203c  ......#include <
0000010: 626f 6f73 742f 696f 7374 7265 616d 732f  boost/iostreams/
0000020: 6465 7669 6365 2f6d 6170 7065 645f 6669  device/mapped_fi
0000030: 6c65 2e68 7070 3e0a 2369 6e63 6c75 6465  le.hpp>.#include
0000040: 203c 626f 6f73 742f 6669 6c65 7379 7374   <boost/filesyst
0000050: 656d 2e68 7070 3e0a 0a75 7369 6e67 2062  em.hpp>..using b
0000060: 6f6f 7374 3a3a 6669 6c65 7379 7374 656d  oost::filesystem
0000070: 3a3a 7061 7468 3b0a 0a20 2020 2076 6f69  ::path;..    voi
0000080: 6420 7072 6570 656e 6428 7061 7468 2066  d prepend(path f
0000090: 6e61 6d65 2c20 7374 643a 3a76 6563 746f  name, std::vecto
00000a0: 723c 7569 6e74 385f 743e 2063 6f6e 7374  r<uint8_t> const
00000b0: 2620 7072 6570 656e 645f 6461 7461 290a  & prepend_data).
00000c0: 2020 2020 7b0a 2020 2020 2020 2020 7573      {.        us
00000d0: 696e 6720 6e61 6d65 7370 6163 6520 626f  ing namespace bo
00000e0: 6f73 743a 3a69 6f73 7472 6561 6d73 3b0a  ost::iostreams;.
00000f0: 2020 2020 2020 2020 6175 746f 2073 697a          auto siz
0000100: 6520 2020 203d 2066 696c 655f 7369 7a65  e    = file_size
0000110: 2866 6e61 6d65 293b 0a20 2020 2020 2020  (fname);.       
0000120: 2061 7574 6f20 7265 7369 7a65 6420 3d20   auto resized = 
0000130: 7369 7a65 202b 2070 7265 7065 6e64 5f64  size + prepend_d
0000140: 6174 612e 7369 7a65 2829 3b0a 0a20 2020  ata.size();..   
0000150: 2020 2020 2062 6f6f 7374 3a3a 6669 6c65       boost::file
0000160: 7379 7374 656d 3a3a 7265 7369 7a65 5f66  system::resize_f
0000170: 696c 6528 666e 616d 652c 2072 6573 697a  ile(fname, resiz
0000180: 6564 293b 0a20 2020 2020 2020 206d 6170  ed);.        map
0000190: 7065 645f 6669 6c65 206d 6628 666e 616d  ped_file mf(fnam
00001a0: 652e 6e61 7469 7665 2829 2e63 5f73 7472  e.native().c_str
00001b0: 2829 293b 0a0a 2020 2020 2020 2020 7374  ());..        st
00001c0: 643a 3a72 6f74 6174 6528 6d66 2e64 6174  d::rotate(mf.dat
00001d0: 6128 292c 206d 662e 6461 7461 2829 202b  a(), mf.data() +
00001e0: 2073 697a 652c 206d 662e 6461 7461 2829   size, mf.data()
00001f0: 202b 2072 6573 697a 6564 293b 0a20 2020   + resized);.   
0000200: 2020 2020 2073 7464 3a3a 636f 7079 2870       std::copy(p
0000210: 7265 7065 6e64 5f64 6174 612e 6265 6769  repend_data.begi
0000220: 6e28 292c 2070 7265 7065 6e64 5f64 6174  n(), prepend_dat
0000230: 612e 656e 6428 292c 206d 662e 6461 7461  a.end(), mf.data
0000240: 2829 293b 0a20 2020 207d 0a0a 696e 7420  ());.    }..int 
0000250: 6d61 696e 2829 207b 0a20 2020 2070 7265  main() {.    pre
0000260: 7065 6e64 2822 6461 7461 2e64 6174 222c  pend("data.dat",
0000270: 207b 2031 2c32 2c33 2c34 2c35 2c36 207d   { 1,2,3,4,5,6 }
0000280: 293b 0a7d 0a                             );.}.
