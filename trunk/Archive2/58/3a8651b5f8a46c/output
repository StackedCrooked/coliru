main.cpp:3:22: error: invalid use of 'this' at top level
    typedef decltype(*this) self;
                      ^
