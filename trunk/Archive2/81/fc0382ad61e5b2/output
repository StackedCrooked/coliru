0000000: 0102 0304 0506 2369 6e63 6c75 6465 203c  ......#include <
0000010: 626f 6f73 742f 696f 7374 7265 616d 732f  boost/iostreams/
0000020: 6465 7669 6365 2f6d 6170 7065 645f 6669  device/mapped_fi
0000030: 6c65 2e68 7070 3e0a 2369 6e63 6c75 6465  le.hpp>.#include
0000040: 203c 626f 6f73 742f 6669 6c65 7379 7374   <boost/filesyst
0000050: 656d 2e68 7070 3e0a 0a75 7369 6e67 2062  em.hpp>..using b
0000060: 6f6f 7374 3a3a 6669 6c65 7379 7374 656d  oost::filesystem
0000070: 3a3a 7061 7468 3b0a 0a20 2020 2076 6f69  ::path;..    voi
0000080: 6420 7072 6570 656e 6428 7061 7468 2066  d prepend(path f
0000090: 6e61 6d65 2c20 7374 643a 3a76 6563 746f  name, std::vecto
00000a0: 723c 7569 6e74 385f 743e 2063 6f6e 7374  r<uint8_t> const
00000b0: 2620 7072 6570 656e 645f 6461 7461 290a  & prepend_data).
00000c0: 2020 2020 7b0a 2020 2020 2020 2020 7573      {.        us
00000d0: 696e 6720 6e61 6d65 7370 6163 6520 626f  ing namespace bo
00000e0: 6f73 743a 3a69 6f73 7472 6561 6d73 3b0a  ost::iostreams;.
00000f0: 2020 2020 2020 2020 6175 746f 2073 697a          auto siz
0000100: 6520 2020 203d 2066 696c 655f 7369 7a65  e    = file_size
0000110: 2866 6e61 6d65 293b 0a20 2020 2020 2020  (fname);.       
0000120: 2061 7574 6f20 7265 7369 7a65 6420 3d20   auto resized = 
0000130: 7369 7a65 202b 2070 7265 7065 6e64 5f64  size + prepend_d
0000140: 6174 612e 7369 7a65 2829 3b0a 0a20 2020  ata.size();..   
0000150: 2020 2020 2072 6573 697a 655f 6669 6c65       resize_file
0000160: 2866 6e61 6d65 2c20 7265 7369 7a65 6429  (fname, resized)
0000170: 3b0a 2020 2020 2020 2020 6d61 7070 6564  ;.        mapped
0000180: 5f66 696c 6520 6d66 2866 6e61 6d65 2e6e  _file mf(fname.n
0000190: 6174 6976 6528 292e 635f 7374 7228 2929  ative().c_str())
00001a0: 3b0a 0a20 2020 2020 2020 2073 7464 3a3a  ;..        std::
00001b0: 726f 7461 7465 286d 662e 6461 7461 2829  rotate(mf.data()
00001c0: 2c20 6d66 2e64 6174 6128 2920 2b20 7369  , mf.data() + si
00001d0: 7a65 2c20 6d66 2e64 6174 6128 2920 2b20  ze, mf.data() + 
00001e0: 7265 7369 7a65 6429 3b0a 2020 2020 2020  resized);.      
00001f0: 2020 7374 643a 3a63 6f70 7928 7072 6570    std::copy(prep
0000200: 656e 645f 6461 7461 2e62 6567 696e 2829  end_data.begin()
0000210: 2c20 7072 6570 656e 645f 6461 7461 2e65  , prepend_data.e
0000220: 6e64 2829 2c20 6d66 2e64 6174 6128 2929  nd(), mf.data())
0000230: 3b0a 2020 2020 7d0a 0a69 6e74 206d 6169  ;.    }..int mai
0000240: 6e28 2920 7b0a 2020 2020 7072 6570 656e  n() {.    prepen
0000250: 6428 2264 6174 612e 6461 7422 2c20 7b20  d("data.dat", { 
0000260: 312c 322c 332c 342c 352c 3620 7d29 3b0a  1,2,3,4,5,6 });.
0000270: 7d0a                                     }.
