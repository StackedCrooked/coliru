<!DOCTYPE html>
<html>
<head>

    <style type="text/css">
        html, body {
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;
        }

        #page {
            padding: 0;
            margin: 0;
            width: 100%;
            height: 100%;

        }

        .vbox {
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;

            -webkit-box-orient: vertical;
            -moz-box-orient: vertical;
            -box-orient: vertical;

            -webkit-box-align: stretch;
            -moz-box-align: stretch;
            -box-align: stretch;
        }

        .hbox {
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;

            -webkit-box-orient: horizontal;
            -moz-box-orient: horizontal;
            -box-orient: horizontal;

            -webkit-box-align: stretch;
            -moz-box-align: stretch;
            -box-align: stretch;
        }

        .col {
            height: 100%;
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;
        }

        .row {
            width: 100%;
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;
        }

        #header {
            min-height: 30px;
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;

            -webkit-box-orient: horizontal;
            -moz-box-orient: horizontal;
            -box-orient: horizontal;

            -webkit-box-align: center;
            -moz-box-align: center;
            -box-align: center;

            width: 100%;
            overflow: hidden;
            font-family: sans-serif;
            font-size: small;
        }

        #middle {
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;

            -webkit-box-orient: vertical;
            -moz-box-orient: vertical;
            -box-orient: vertical;

            -webkit-box-align: stretch;
            -moz-box-align: stretch;
            -box-align: stretch;

            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .flex0 {
            -webkit-box-flex: 0.0;
            -moz-box-flex: 0.0;
            -box-flex: 0.0;
        }

        .flex1 {
            -webkit-box-flex: 1.0;
            -moz-box-flex: 1.0;
            -box-flex: 1.0;
        }

        .fake-margin {
            min-height: 0px;

        }

        #editor {
            position: relative;
        }

        #left {
            min-width: 0px;
        }

        #right {
            min-width: 0px;
        }

        #output {
            font-family: monospace;
            overflow: auto;
            height: 200px;
        }

        #footer {
            min-height: 30px;
            display: -webkit-box;
            display: -moz-box-box;
            display: -box;

            -webkit-box-orient: horizontal;
            -moz-box-orient: horizontal;
            -box-orient: horizontal;

            -webkit-box-align: center;
            -moz-box-align: center;
            -box-align: center;

            width: 100%;
            overflow: hidden;
            font-family: sans-serif;
            font-size: small;
        }

        .surrounding {
            background-color: #d3d3d3;
        }

        textarea {
            border-width: medium;
            border-color: #add8e6;
        }

        input:focus, textarea:focus {
            outline: none;
        }
        button {
            height: 23px;
            margin: 7px;
        }
    </style>

</head>
<body>

<div id="page" class="hbox">
    <div id="left" class="col flex0"></div>
    <div id="middle" class="vbox col flex1">
        <div class="fake-margin row flex0 "></div>
        <div id="header" class="surrounding row flex0"></div>
        <div id="editor" class="row flex1"></div>
        <div class="fake-margin row flex0"></div>
        <label for="output"></label><textarea id="output" class="row flex0" contenteditable="false"
                                              rows="10"></textarea>

        <div id="footer" class="surrounding row flex0 hbox">
            <div class="flex1"></div>
            <button onclick="app.postSample(); return;">Post Sample!</button>
            <div class="flex1"></div>
        </div>
        <!--<a id="share" class="row flex0" href="#" onclick="app.share(); return;">Share</a>-->

        <div class="fake-margin row flex0"></div>
    </div>
    <div id="right" class="col flex0"></div>
</div>
<script src="http://d1n0x3qji82z53.cloudfront.net/src-min-noconflict/ace.js" type="text/javascript"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/textmate");
    editor.getSession().setMode("ace/mode/c_cpp");
    editor.setBehavioursEnabled(false);

    Element.prototype.createChild = function (tagNamePath) {
        "use strict";
        var result = this;
        var tagNames = tagNamePath.split("/");
        for (var i = 0; i < tagNames.length; ++i) {
            var child = document.createElement(tagNames[i]);
            result.appendChild(child);
            result = child;
        }
        return result;
    };


    var app = {
        samples: {
            "Hello World!": "#include <iostream>\n\nint main()\n{\n\tstd::cout << \"Hello World!\" << std::endl;\n}",
            "Variadic Templates": "#include <iostream>\n#include <stdexcept>\n\nnamespace cpp {\n\nvoid printf(const char* s)\n{\n  while (*s) {\n    if (*s == '%' && *++s != '%') \n      throw std::runtime_error(\"invalid format string: missing arguments\");\n    std::cout << *s++;\n  }\n}\n\ntemplate<typename T, typename... Args>\nvoid printf(const char* s, const T& value, const Args&... args)\n{\n  while (*s) {\n    if (*s == '%' && *++s != '%') {\n      std::cout << value;\n      return printf(++s, args...);\n    }\n    std::cout << *s++;\n  }\n  throw std::runtime_error(\"extra arguments provided to printf\");\n}\n\n} // namespace cpp\n\nint main()\n{\n    // classic printf\n    printf(\"%u\\n\", -1);\n       \n    // C++ variadic printf\n    cpp::printf(\"%u\\n\", -1);\n}"

        },
        elements: {
            header: document.getElementById("header"),
            editor: document.getElementById("editor"),
            output: document.getElementById("output")
        }
    };

    window.onload = function () {
        var x = new XMLHttpRequest(); x.open("GET", "Archive/" + window.location.search.split('=')[1] + "/output.txt", false); x.send(null);
        app.elements.output.value = x.responseText;


        x = new XMLHttpRequest(); x.open("GET", "Archive/" + window.location.search.split('=')[1] + "/main.cpp", false); x.send(null);
        editor.setValue(x.responseText);
        editor.clearSelection();

        // Add event handles for the samples.
        for (var name in app.samples) {
            var link = header.createChild("a");
            link.href = "#";
            link.class = 'sample col flex0 box';
            link.fontWeight = 'thicker';
            link.innerText = name;
            link.style.margin = "4px";
            link.style.fontSize = "normal";
            link.onclick = function () {
                editor.setValue(app.samples[this.innerText]);
                editor.clearSelection();
            };
        }
    };
</script>


</body>
</html>
